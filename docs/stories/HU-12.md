# HU-12 — Motor de Detección: Regresión, Meseta y Necesidad de Descarga

## Requisitos relacionados

RF29, RF30, RF34, RF35, RF36, RF37, RNF05

## Descripción

Como ejecutante, quiero que el sistema detecte automáticamente regresiones en mis ejercicios, identifique fatiga acumulada del módulo, diagnostique mesetas con análisis causal, me recomiende acciones correctivas escalonadas y señale cuando un módulo completo necesita descarga, para tener un diagnóstico integral y objetivo de mi estado de entrenamiento que me permita tomar decisiones informadas antes de que la acumulación de fatiga comprometa mi progreso.

## Historias originales consolidadas

Esta historia consolida las siguientes historias del diseño original, que forman una cadena de decisión inseparable (detectar → diagnosticar → prescribir → escalar):

- **HU-12 original** — Detectar regresión y fatiga acumulada (RF29, RF30)
- **HU-14 original** — Detectar y alertar meseta en ejercicios (RF34, RF35)
- **HU-15 original** — Recomendar acciones correctivas escalonadas ante meseta (RF36)
- **HU-16 original** — Detectar necesidad de descarga por módulo (RF37)

---

## Criterios de Aceptación

### Bloque A — Detección de Regresión (RF29)

#### CA-12.01 — Detección de regresión por caída de repeticiones

**Dado que** el sistema compara un ejercicio contra su último registro histórico al cerrar una sesión,
**cuando** detecta que el peso utilizado es igual al de la sesión anterior pero las repeticiones cayeron en ≥ 2 de las 4 series,
**entonces** clasifica al ejercicio con "Regresión" para esta sesión.

#### CA-12.02 — Detección de regresión por aumento de RIR

**Dado que** el sistema compara un ejercicio contra su último registro histórico al cerrar una sesión,
**cuando** detecta que la carga es la misma, las repeticiones son similares a la sesión anterior, pero el RIR promedio subió en ≥ 1.5 puntos,
**entonces** clasifica al ejercicio con "Regresión" para esta sesión, interpretando que el ejecutante necesitó más esfuerzo percibido para mantener el mismo rendimiento.

#### CA-12.03 — Regresión por caída de carga

**Dado que** el sistema compara un ejercicio contra su último registro histórico,
**cuando** detecta que el peso utilizado es menor al de la sesión anterior,
**entonces** clasifica al ejercicio con "Regresión" para esta sesión.

### Bloque B — Detección de Fatiga Acumulada del Módulo (RF30)

#### CA-12.04 — Detección de fatiga acumulada del módulo

**Dado que** el sistema ha clasificado la progresión de todos los ejercicios registrados en la sesión,
**cuando** identifica regresión simultánea en ≥ 50% de los ejercicios de esa sesión,
**entonces** detecta y registra "Fatiga acumulada del módulo" para el módulo de la sesión.

#### CA-12.05 — Umbral del 50% calculado sobre ejercicios registrados

**Dado que** una sesión se cierra como Incompleta con menos ejercicios registrados que los prescritos,
**cuando** el sistema evalúa fatiga acumulada,
**entonces** calcula el umbral del 50% sobre los ejercicios que efectivamente tienen registros en la sesión, no sobre el total de ejercicios prescritos.

#### CA-12.06 — Registro de las detecciones

**Dado que** el sistema detecta regresión en un ejercicio o fatiga acumulada en un módulo,
**cuando** completa el análisis post-sesión,
**entonces** persiste las detecciones vinculadas a la sesión para su uso en reglas de decisión posteriores (mesetas, alertas de descarga, KPIs).

### Bloque C — Detección de Meseta (RF34, RF35)

#### CA-12.07 — Detección de meseta por 3 sesiones sin progresión

**Dado que** el sistema evalúa la progresión de un ejercicio al cerrar una sesión,
**cuando** detecta que el ejercicio no ha registrado progresión positiva (ni aumento de carga ni aumento de repeticiones) durante 3 sesiones consecutivas del mismo ejercicio,
**entonces** marca el ejercicio con estado "En Meseta".

#### CA-12.08 — Sesiones consecutivas del mismo ejercicio

**Dado que** el sistema evalúa si un ejercicio está en meseta,
**cuando** cuenta las sesiones consecutivas sin progresión,
**entonces** solo cuenta sesiones que incluyen ese ejercicio específico, sin importar cuántas sesiones de otros módulos hayan ocurrido entre ellas; la consecutividad es del ejercicio, no del calendario.

#### CA-12.09 — Alerta de meseta al ejecutante

**Dado que** un ejercicio entra en estado de "En Meseta",
**cuando** el sistema completa la detección,
**entonces** emite una alerta visible al ejecutante indicando el nombre del ejercicio en meseta y que lleva 3 sesiones sin progresión.

#### CA-12.10 — Análisis causal: RIR bajo indica límite de carga

**Dado que** un ejercicio entra en meseta,
**cuando** el sistema analiza los datos de las últimas 3 sesiones y el RIR promedio es consistentemente bajo (0-1),
**entonces** la alerta incluye el análisis causal: "El ejecutante está entrenando cerca del fallo técnico — posible límite de carga con este peso. El cuerpo no tiene reserva suficiente para progresar."

#### CA-12.11 — Análisis causal: RIR alto indica carga conservadora

**Dado que** un ejercicio entra en meseta,
**cuando** el sistema analiza los datos de las últimas 3 sesiones y el RIR promedio es alto (3+),
**entonces** la alerta incluye el análisis causal: "El ejecutante mantiene reserva alta — posible carga conservadora. El estímulo puede ser insuficiente para generar adaptación."

#### CA-12.12 — Análisis causal: estancamiento grupal indica fatiga sistémica

**Dado que** un ejercicio entra en meseta,
**cuando** el sistema detecta que otros ejercicios del mismo grupo muscular también están estancados o en meseta,
**entonces** la alerta incluye el análisis causal: "Múltiples ejercicios del mismo grupo muscular estancados — posible fatiga sistémica del grupo muscular."

#### CA-12.13 — Señales visuales diferenciadas

**Dado que** el sistema emite una alerta de meseta,
**cuando** el ejecutante visualiza la alerta,
**entonces** la alerta es visualmente distinguible mediante colores e iconografía específica para meseta, diferenciándose de las señales de progresión positiva y regresión, sin depender únicamente del texto.

#### CA-12.14 — Actualización del estado del ejercicio

**Dado que** un ejercicio entra en meseta,
**cuando** el sistema actualiza el estado persistente de progresión,
**entonces** el estado del ejercicio cambia de "En Progresión" a "En Meseta" y permanece así hasta que se registre progresión positiva o se active una descarga.

### Bloque D — Acciones Correctivas Escalonadas ante Meseta (RF36)

#### CA-12.15 — Recomendación en sesión 4 sin progreso

**Dado que** un ejercicio lleva 4 sesiones consecutivas sin progresión positiva (1 sesión más allá de la detección de meseta),
**cuando** el sistema emite la recomendación,
**entonces** recomienda al ejecutante: aplicar un microincremento de carga (la menor carga posible disponible) o intentar extender las repeticiones dentro del rango (buscar llegar a 12 reps antes de subir carga), presentando ambas opciones como alternativas.

#### CA-12.16 — Recomendación en sesión 6 sin progreso

**Dado que** un ejercicio lleva 6 sesiones consecutivas sin progresión positiva,
**cuando** el sistema emite la recomendación,
**entonces** recomienda al ejecutante: rotar a otra versión del módulo para cambiar el patrón de estímulo muscular, indicando que la versión actual puede haber agotado su efecto adaptativo para ese ejercicio.

#### CA-12.17 — Escalonamiento acumulativo

**Dado que** un ejercicio alcanza la sesión 6 sin progreso,
**cuando** el sistema presenta la recomendación,
**entonces** muestra la recomendación de sesión 6 (rotar versión) como complemento a la de sesión 4 (microincremento o extensión de reps), indicando que ambas estrategias pueden combinarse.

#### CA-12.18 — Recomendaciones informativas, no bloqueantes

**Dado que** el sistema emite una recomendación correctiva,
**cuando** el ejecutante visualiza la recomendación,
**entonces** la recomendación es informativa: el ejecutante puede seguirla o ignorarla. El sistema no impide iniciar ni completar una sesión por existir una recomendación pendiente.

#### CA-12.19 — Vinculación con la alerta de meseta

**Dado que** un ejercicio está en meseta y el sistema ha emitido una alerta,
**cuando** el sistema emite las recomendaciones correctivas,
**entonces** las presenta asociadas a la alerta de meseta del ejercicio, permitiendo al ejecutante ver el diagnóstico (análisis causal) y la prescripción (acción correctiva) de forma conjunta.

### Bloque E — Detección de Necesidad de Descarga por Módulo (RF37)

#### CA-12.20 — Detección por meseta/regresión simultánea

**Dado que** el sistema evalúa el estado de los ejercicios de un módulo al cerrar una sesión,
**cuando** detecta que ≥ 50% de los ejercicios del módulo están simultáneamente en estado de "En Meseta" o clasificados con "Regresión" en la sesión actual,
**entonces** marca el módulo como "Requiere descarga" y emite una señal al ejecutante.

#### CA-12.21 — Detección por fatiga acumulada del módulo

**Dado que** el sistema ha detectado fatiga acumulada del módulo en la sesión actual (regresión simultánea en ≥ 50% de los ejercicios — CA-12.04),
**cuando** completa el análisis post-sesión,
**entonces** marca el módulo como "Requiere descarga" y emite una señal al ejecutante, independientemente del estado de meseta de los ejercicios individuales.

#### CA-12.22 — Cálculo del umbral del 50%

**Dado que** el sistema evalúa si un módulo requiere descarga,
**cuando** calcula el porcentaje de ejercicios en meseta/regresión,
**entonces** lo calcula sobre el total de ejercicios prescritos para la versión del módulo actualmente en ejecución (11 para A, 11 para B, 9 para C).

#### CA-12.23 — Señal informativa, no bloqueante

**Dado que** el sistema detecta que un módulo requiere descarga,
**cuando** emite la señal al ejecutante,
**entonces** la señal es informativa y recomienda activar el modo de descarga (HU-14), pero no impide al ejecutante continuar entrenando con la carga normal si así lo decide.

#### CA-12.24 — Registro de la detección

**Dado que** el sistema detecta que un módulo requiere descarga,
**cuando** completa la evaluación,
**entonces** persiste la detección con la fecha y el módulo afectado, disponible para consulta en el historial.
